<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<title>SANTIS CARD DEBUG</title>
<style>
body { background:#111; color:#eee; font-family:monospace; padding:20px; }
.ok { color:#0f0; } .fail { color:#f44; } .warn { color:#ff0; }
pre { background:#222; padding:10px; border-radius:8px; overflow-x:auto; }
button { padding:8px 16px; margin:4px; cursor:pointer; }
</style>
<meta content="Santis Club'ta ruhunuzu ve bedeninizi tazeleyecek Ã¶zel spa, masaj, hamam ve cilt bakÄ±mÄ± ritÃ¼ellerini keÅŸfedin." name="description"/><meta content="website" property="og:type"/><meta content="SANTIS CARD DEBUG" property="og:title"/><meta content="Santis Club'ta ruhunuzu ve bedeninizi tazeleyecek Ã¶zel spa, masaj, hamam ve cilt bakÄ±mÄ± ritÃ¼ellerini keÅŸfedin." property="og:description"/><meta content="https://santisclub.com/_debug_cards.html" property="og:url"/><meta content="https://santisclub.com/assets/img/logo-santis.png" property="og:image"/><meta content="Santis Club" property="og:site_name"/><meta content="summary_large_image" name="twitter:card"/><meta content="SANTIS CARD DEBUG" name="twitter:title"/><meta content="Santis Club'ta ruhunuzu ve bedeninizi tazeleyecek Ã¶zel spa, masaj, hamam ve cilt bakÄ±mÄ± ritÃ¼ellerini keÅŸfedin." name="twitter:description"/><meta content="https://santisclub.com/assets/img/logo-santis.png" name="twitter:image"/></head>
<body>
<h1>ğŸ” SANTIS KART DEBUG PANELI</h1>
<div id="log"></div>
<script>
const log = document.getElementById('log');
function add(cls, msg) {
    log.innerHTML += `<p class="${cls}">${msg}</p>`;
}

async function runDiagnostic() {
    add('', 'â”â”â” 1. services.json KONTROLÃœ â”â”â”');
    try {
        const r = await fetch('/assets/data/services.json?t=' + Date.now());
        if (!r.ok) { add('fail', `âŒ services.json HATA: ${r.status}`); return; }
        const data = await r.json();
        add('ok', `âœ… services.json OK â€” ${data.length} item`);
        
        // Category distribution
        const cats = {};
        data.forEach(x => {
            const c = x.categoryId || '?';
            cats[c] = (cats[c]||0) + 1;
        });
        add('', '<pre>' + JSON.stringify(cats, null, 2) + '</pre>');
        
        // Slug list
        add('', 'â”â”â” 2. SLUG LÄ°STESÄ° â”â”â”');
        data.forEach(x => {
            add('', `  [${x.categoryId}] id=${x.id} slug=${x.slug}`);
        });
    } catch(e) {
        add('fail', `âŒ services.json FETCH HATA: ${e.message}`);
    }
    
    add('', 'â”â”â” 3. data-bridge.js DAÄITIM TESTÄ° â”â”â”');
    // Simulate data-bridge distribution
    try {
        const r = await fetch('/assets/data/services.json?t=' + Date.now());
        const items = await r.json();
        
        const NV_MASSAGES = [];
        const NV_HAMMAM = [];
        const NV_SKINCARE = [];
        const NV_PRODUCTS = [];
        
        items.forEach(item => {
            const cat = (item.categoryId || '').toLowerCase();
            if (cat.includes('massage')) {
                NV_MASSAGES.push(item);
            } else if (cat.includes('hammam') || cat.includes('hamam')) {
                NV_HAMMAM.push(item);
            } else if (cat.includes('facial') || cat.includes('skin') || cat.includes('sothys') || cat.includes('face')) {
                NV_SKINCARE.push(item);
            } else {
                NV_PRODUCTS.push(item);
            }
        });
        
        add(NV_HAMMAM.length > 0 ? 'ok' : 'fail', `HAMAM: ${NV_HAMMAM.length} items`);
        add(NV_MASSAGES.length > 0 ? 'ok' : 'fail', `MASSAGE: ${NV_MASSAGES.length} items`);
        add(NV_SKINCARE.length > 0 ? 'ok' : 'fail', `SKINCARE: ${NV_SKINCARE.length} items`);
        add(NV_PRODUCTS.length > 0 ? 'warn' : 'ok', `PRODUCTS (fallback): ${NV_PRODUCTS.length} items`);
        
        if (NV_MASSAGES.length > 0) {
            add('', '<b>Ä°lk 3 masaj slug:</b>');
            NV_MASSAGES.slice(0,3).forEach(m => add('', `  â†’ ${m.slug} (id: ${m.id})`));
        }
        if (NV_SKINCARE.length > 0) {
            add('', '<b>Ä°lk 3 skincare slug:</b>');
            NV_SKINCARE.slice(0,3).forEach(m => add('', `  â†’ ${m.slug} (id: ${m.id})`));
        }
        
        add('', 'â”â”â” 4. service-detail.html EÅLEÅME TESTÄ° â”â”â”');
        // Test each slug against lookup
        let matchOk = 0, matchFail = 0;
        items.forEach(item => {
            const searchId = item.slug || item.id;
            const found = items.find(p => p.id === searchId || p.slug === searchId);
            if (found) matchOk++;
            else { matchFail++; add('fail', `âŒ SLUG BULUNAMADI: ${searchId}`); }
        });
        add(matchFail === 0 ? 'ok' : 'fail', `Slug eÅŸleÅŸme: ${matchOk}/${items.length} OK, ${matchFail} FAIL`);
        
    } catch(e) {
        add('fail', `âŒ Distribution test failed: ${e.message}`);
    }
    
    add('', 'â”â”â” 5. service-detail.html ERÄ°ÅÄ°M TESTÄ° â”â”â”');
    try {
        const r = await fetch('/service-detail.html?t=' + Date.now());
        add(r.ok ? 'ok' : 'fail', `service-detail.html: ${r.status} ${r.statusText}`);
    } catch(e) {
        add('fail', `âŒ service-detail.html eriÅŸim: ${e.message}`);
    }
    
    add('', 'â”â”â” 6. KART TIKLAMA SÄ°MÃœLASYONU â”â”â”');
    try {
        const r = await fetch('/assets/data/services.json');
        const items = await r.json();
        const test = items.find(x => x.categoryId && x.categoryId.includes('massage'));
        if (test) {
            const slug = test.slug || test.id;
            const url = `/service-detail.html?slug=${slug}`;
            add('ok', `Test URL: <a href="${url}" target="_blank" style="color:cyan">${url}</a>`);
            add('', `â†’ YukarÄ±daki linke tÄ±klayÄ±p detay sayfasÄ± aÃ§Ä±lÄ±yor mu kontrol et!`);
        }
    } catch(e) {}
    
    add('', 'â”â”â” 7. SONUÃ‡ â”â”â”');
    add('warn', 'âš ï¸ Bu sayfayÄ± Live Server ile aÃ§tÄ±ysan sonuÃ§lar doÄŸru.');
    add('warn', 'âš ï¸ Masajlar sayfasÄ±nÄ± kontrol etmek iÃ§in: <a href="/tr/masajlar/index.html" style="color:cyan">/tr/masajlar/index.html</a>');
}

runDiagnostic();
</script>
</body>
</html>
