<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout ‚Ä¢ Santis Club</title>

    <!-- SEO Meta (Replace with actual values) -->
    <meta name="description"
        content="Complete your purchase securely. Fast checkout with Stripe and Mollie payment options.">
    <meta name="robots" content="noindex, nofollow">

    <link rel="stylesheet" href="assets/css/style.css">
    <style>
        .checkout-container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 40px;
        }

        .checkout-main {
            background: white;
            padding: 32px;
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.08);
        }

        .checkout-sidebar {
            background: #f8f9fa;
            padding: 24px;
            border-radius: 12px;
            height: fit-content;
            position: sticky;
            top: 100px;
        }

        .section {
            margin-bottom: 32px;
            padding-bottom: 32px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        }

        .section:last-child {
            border-bottom: none;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #202124;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            font-size: 14px;
            color: #5f6368;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid rgba(0, 0, 0, 0.12);
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .channel-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 24px;
        }

        .channel-option {
            padding: 16px;
            border: 2px solid rgba(0, 0, 0, 0.12);
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .channel-option:hover {
            border-color: rgba(212, 175, 55, 0.4);
            background: rgba(212, 175, 55, 0.05);
        }

        .channel-option.active {
            border-color: #d4af37;
            background: rgba(212, 175, 55, 0.1);
        }

        .channel-option-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .channel-option-title {
            font-weight: 600;
            font-size: 14px;
            color: #202124;
        }

        .order-summary {
            margin-bottom: 20px;
        }

        .order-item {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .order-item-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 6px;
        }

        .order-item-details {
            flex: 1;
        }

        .order-item-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .order-item-meta {
            font-size: 12px;
            color: #5f6368;
        }

        .order-item-price {
            font-weight: 600;
            color: #202124;
        }

        .order-totals {
            padding-top: 16px;
            border-top: 2px solid rgba(0, 0, 0, 0.12);
        }

        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .total-row.grand-total {
            font-size: 18px;
            font-weight: 700;
            color: #202124;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(0, 0, 0, 0.08);
        }

        .payment-methods {
            display: grid;
            gap: 12px;
        }

        .payment-method {
            padding: 16px;
            border: 2px solid rgba(0, 0, 0, 0.12);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s;
        }

        .payment-method:hover {
            border-color: rgba(212, 175, 55, 0.4);
            background: rgba(212, 175, 55, 0.05);
        }

        .payment-method.active {
            border-color: #d4af37;
            background: rgba(212, 175, 55, 0.1);
        }

        .payment-method-icon {
            width: 48px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 4px;
            font-weight: 700;
            font-size: 12px;
        }

        .checkout-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #d4af37 0%, #c49a2d 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .checkout-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        .checkout-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .security-badge {
            text-align: center;
            padding: 12px;
            background: rgba(0, 0, 0, 0.03);
            border-radius: 6px;
            font-size: 12px;
            color: #5f6368;
            margin-top: 16px;
        }

        .security-badge svg {
            vertical-align: middle;
            margin-right: 6px;
        }

        @media (max-width: 768px) {
            .checkout-container {
                grid-template-columns: 1fr;
            }

            .checkout-sidebar {
                position: static;
                order: -1;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- Navbar -->
    <div id="navbar-container"></div>

    <div class="checkout-container">
        <!-- Main Checkout Form -->
        <div class="checkout-main">
            <h1 style="margin-bottom: 24px; font-size: 28px;">Checkout</h1>

            <!-- Delivery Channel Selector -->
            <div class="section">
                <div class="section-title">Teslimat Y√∂ntemi</div>
                <div class="channel-selector">
                    <div class="channel-option active" data-channel="hotel_in" onclick="selectChannel('hotel_in')">
                        <div class="channel-option-icon">üè®</div>
                        <div class="channel-option-title">Otel ƒ∞√ßi</div>
                    </div>
                    <div class="channel-option" data-channel="hotel_out" onclick="selectChannel('hotel_out')">
                        <div class="channel-option-icon">üì¶</div>
                        <div class="channel-option-title">Kargo</div>
                    </div>
                </div>
            </div>

            <!-- Contact Information -->
            <div class="section">
                <div class="section-title">ƒ∞leti≈üim Bilgileri</div>
                <div class="form-group">
                    <label>Ad Soyad *</label>
                    <input type="text" id="customer_name" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Telefon *</label>
                        <input type="tel" id="customer_phone" placeholder="+90..." required>
                    </div>
                    <div class="form-group">
                        <label>E-posta (opsiyonel)</label>
                        <input type="email" id="customer_email">
                    </div>
                </div>
            </div>

            <!-- Hotel In Fields -->
            <div class="section" id="section-hotel-in">
                <div class="section-title">Otel Bilgileri</div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Oda No *</label>
                        <input type="text" id="room_no" placeholder="1206">
                    </div>
                    <div class="form-group">
                        <label>Teslim Noktasƒ± *</label>
                        <select id="delivery_point">
                            <option value="room">Oda</option>
                            <option value="spa">Spa</option>
                            <option value="lobby">Lobi</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Teslim Zamanƒ± *</label>
                    <select id="delivery_slot">
                        <option value="asap">Hemen</option>
                        <option value="30_60">30-60 dakika</option>
                        <option value="60_120">60-120 dakika</option>
                        <option value="scheduled">Saat se√ß</option>
                    </select>
                </div>
            </div>

            <!-- Hotel Out Fields -->
            <div class="section" id="section-hotel-out" style="display:none;">
                <div class="section-title">Teslimat Adresi</div>
                <div class="form-group">
                    <label>√úlke *</label>
                    <select id="country">
                        <option value="TR">T√ºrkiye</option>
                        <option value="NL">Hollanda</option>
                        <option value="DE">Almanya</option>
                        <option value="FR">Fransa</option>
                        <option value="BE">Bel√ßika</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>≈ûehir *</label>
                        <input type="text" id="city">
                    </div>
                    <div class="form-group">
                        <label>Posta Kodu *</label>
                        <input type="text" id="postcode">
                    </div>
                </div>
                <div class="form-group">
                    <label>Adres *</label>
                    <input type="text" id="address1">
                </div>
                <div class="form-group">
                    <label>Adres 2 (opsiyonel)</label>
                    <input type="text" id="address2">
                </div>
            </div>

            <!-- Payment Method -->
            <div class="section">
                <div class="section-title">√ñdeme Y√∂ntemi</div>
                <div class="payment-methods">
                    <div class="payment-method active" data-method="stripe" onclick="selectPayment('stripe')">
                        <div class="payment-method-icon" style="color:#635bff;">STRIPE</div>
                        <div>
                            <div style="font-weight:600;">Kredi Kartƒ±</div>
                            <div style="font-size:12px;color:#5f6368;">Visa, Mastercard, Amex</div>
                        </div>
                    </div>
                    <div class="payment-method" data-method="mollie" onclick="selectPayment('mollie')">
                        <div class="payment-method-icon" style="color:#000;">MOLLIE</div>
                        <div>
                            <div style="font-weight:600;">iDEAL, Bancontact</div>
                            <div style="font-size:12px;color:#5f6368;">Avrupa √∂demeleri</div>
                        </div>
                    </div>
                </div>
            </div>

            <button class="checkout-btn" onclick="proceedToPayment()">
                √ñdemeye Ge√ß
            </button>
        </div>

        <!-- Order Summary Sidebar -->
        <aside class="checkout-sidebar">
            <div class="section-title">Sipari≈ü √ñzeti</div>
            <div class="order-summary" id="order-summary">
                <!-- Filled by JS -->
            </div>

            <div class="order-totals">
                <div class="total-row">
                    <span>√úr√ºnler</span>
                    <span id="total-items">0‚Ç¨</span>
                </div>
                <div class="total-row">
                    <span>Kargo</span>
                    <span id="total-shipping">0‚Ç¨</span>
                </div>
                <div class="total-row grand-total">
                    <span>Toplam</span>
                    <span id="total-grand">0‚Ç¨</span>
                </div>
            </div>

            <div class="security-badge">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                </svg>
                G√ºvenli SSL √∂deme
            </div>
        </aside>
    </div>

    <!-- Footer -->
    <div id="footer-container"></div>

    <script src="assets/js/db.js"></script>
    <script src="assets/js/app.js"></script>
    <script src="assets/js/shop.js"></script>

    <script>
        let checkoutState = {
            channel: 'hotel_in',
            paymentMethod: 'stripe'
        };

        async function loadComponents() {
            try {
                const navbar = await fetch('components/navbar.html').then(r => r.text());
                document.getElementById('navbar-container').innerHTML = navbar;

                const footer = await fetch('components/footer.html').then(r => r.text());
                document.getElementById('footer-container').innerHTML = footer;
            } catch (e) {
                console.warn('Component load failed:', e);
            }
        }

        function selectChannel(channel) {
            checkoutState.channel = channel;

            // Update UI
            document.querySelectorAll('.channel-option').forEach(el => {
                el.classList.toggle('active', el.dataset.channel === channel);
            });

            // Show/hide sections
            document.getElementById('section-hotel-in').style.display =
                channel === 'hotel_in' ? 'block' : 'none';
            document.getElementById('section-hotel-out').style.display =
                channel === 'hotel_out' ? 'block' : 'none';

            updateShipping();
        }

        function selectPayment(method) {
            checkoutState.paymentMethod = method;

            document.querySelectorAll('.payment-method').forEach(el => {
                el.classList.toggle('active', el.dataset.method === method);
            });
        }

        function updateShipping() {
            const shipping = checkoutState.channel === 'hotel_in' ? 0 : 15;
            document.getElementById('total-shipping').textContent = `${shipping}‚Ç¨`;
            updateGrandTotal();
        }

        function updateGrandTotal() {
            const items = parseFloat(document.getElementById('total-items').textContent);
            const shipping = parseFloat(document.getElementById('total-shipping').textContent);
            const total = items + shipping;
            document.getElementById('total-grand').textContent = `${total.toFixed(0)}‚Ç¨`;
        }

        function renderOrderSummary() {
            const cart = SHOP?.cart || [];
            const container = document.getElementById('order-summary');

            if (!cart.length) {
                container.innerHTML = '<p style="text-align:center;color:#5f6368;">Sepetiniz bo≈ü</p>';
                return;
            }

            let itemsTotal = 0;
            container.innerHTML = cart.map(item => {
                itemsTotal += item.price * item.qty;
                return `
                    <div class="order-item">
                        <img src="${item.img}" class="order-item-image" alt="${item.name.tr}">
                        <div class="order-item-details">
                            <div class="order-item-name">${item.name.tr}</div>
                            <div class="order-item-meta">Adet: ${item.qty}</div>
                        </div>
                        <div class="order-item-price">${(item.price * item.qty).toFixed(0)}‚Ç¨</div>
                    </div>
                `;
            }).join('');

            document.getElementById('total-items').textContent = `${itemsTotal.toFixed(0)}‚Ç¨`;
            updateShipping();
        }

        async function proceedToPayment() {
            // Validate form
            const name = document.getElementById('customer_name').value;
            const phone = document.getElementById('customer_phone').value;

            if (!name || !phone) {
                alert('L√ºtfen gerekli alanlarƒ± doldurun');
                return;
            }

            // Prepare order data
            const orderData = {
                channel: checkoutState.channel,
                paymentMethod: checkoutState.paymentMethod,
                customer: {
                    name,
                    phone,
                    email: document.getElementById('customer_email').value
                },
                items: SHOP.cart,
                total: parseFloat(document.getElementById('total-grand').textContent)
            };

            if (checkoutState.channel === 'hotel_in') {
                orderData.delivery = {
                    room_no: document.getElementById('room_no').value,
                    point: document.getElementById('delivery_point').value,
                    slot: document.getElementById('delivery_slot').value
                };
            } else {
                orderData.shipping = {
                    country: document.getElementById('country').value,
                    city: document.getElementById('city').value,
                    postcode: document.getElementById('postcode').value,
                    address1: document.getElementById('address1').value,
                    address2: document.getElementById('address2').value
                };
            }

            console.log('Order data:', orderData);

            // TODO: Send to backend, get payment URL
            alert('√ñdeme entegrasyonu yakƒ±nda! Order data console\'da.');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            loadComponents();
            renderOrderSummary();

            // Refresh summary when cart changes
            setInterval(renderOrderSummary, 1000);
        });
    </script>
</body>

</html>