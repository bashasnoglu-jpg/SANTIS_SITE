<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Santis Club Test Raporu</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: #121212; color: #e0e0e0; }
    h1 { color: #64b5f6; border-bottom: 1px solid #333; padding-bottom: 10px; }
    .summary-box { display: flex; gap: 20px; margin: 20px 0; }
    .card { background: #1e1e1e; padding: 15px; border-radius: 8px; min-width: 150px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
    .card h3 { margin: 0 0 5px; font-size: 2em; }
    .card span { color: #888; font-size: 0.9em; text-transform: uppercase; }
    .pass { color: #4caf50; }
    .fail { color: #f44336; }
    
    table { width: 100%; border-collapse: collapse; background: #1e1e1e; border-radius: 8px; overflow: hidden; }
    th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #333; }
    th { background: #252525; color: #aaa; font-weight: 600; }
    tr:hover { background: #2a2a2a; }
    .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.8em; font-weight: bold; }
    .bg-pass { background: rgba(76, 175, 80, 0.2); color: #81c784; }
    .bg-fail { background: rgba(244, 67, 54, 0.2); color: #e57373; }
    .bg-warn { background: rgba(255, 152, 0, 0.2); color: #ffb74d; }
    
    .filter-bar { margin-bottom: 15px; }
    button { background: #333; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-right: 10px; }
    button:hover { background: #444; }
    button.active { background: #64b5f6; color: #000; }
  </style>
</head>
<body>
  <h1>üõ°Ô∏è Santis Club Sistem Saƒülƒ±k Raporu</h1>
  
  <div class="summary-box">
    <div class="card"><h3 id="totalCount">-</h3><span>Toplam Test</span></div>
    <div class="card"><h3 id="passCount" class="pass">-</h3><span>Ba≈üarƒ±lƒ±</span></div>
    <div class="card"><h3 id="failCount" class="fail">-</h3><span>Hatalƒ±</span></div>
  </div>

  <div class="filter-bar">
    <button data-filter="all" onclick="filter('all')" class="active">T√ºm√º</button>
    <button data-filter="fail" onclick="filter('fail')">Sadece Hatalar</button>
  </div>

  <table id="resultsTable">
    <thead>
      <tr>
        <th width="100">Durum</th>
        <th width="150">Kategori</th>
        <th>Detay</th>
        <th>Mesaj / URL</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>

  <script>window.SANTIS_TEST_MANUAL_START = true;</script>
  <script src="test-runner-schema.js"></script>
  <script>
    const results = [];
    const logger = {
      log: (msg, style) => processLog(msg, style, 'info'),
      error: (msg, style) => processLog(msg, style, 'fail'),
      warn: (msg, style) => processLog(msg, style, 'warn'),
      group: () => {}, groupEnd: () => {}
    };

    function processLog(msg, style, defaultType) {
      let type = defaultType;
      if (style && style.includes('#4caf50')) type = 'pass';
      else if (style && style.includes('#f44336')) type = 'fail';
      else if (style && style.includes('#ff9800')) type = 'warn';
      
      const cleanMsg = String(msg).replace('%c', '').trim();
      if (!cleanMsg) return;

      let category = 'Genel';
      if (cleanMsg.includes('JSON')) category = 'JSON Yapƒ±sƒ±';
      else if (cleanMsg.includes('hotel.html')) category = 'Sayfa: Hotel';
      else if (cleanMsg.includes('service.html')) category = 'Sayfa: Service';
      else if (cleanMsg.includes('booking.html')) category = 'Sayfa: Booking';
      else if (cleanMsg.includes('Hotel[')) category = 'Veri: Hotel';

      results.push({ type, category, msg: cleanMsg });
      renderRow(type, category, cleanMsg);
      updateStats();
      renderEmptyFailState();
    }

    function renderRow(type, cat, msg) {
      const tbody = document.getElementById('tableBody');
      const tr = document.createElement('tr');
      tr.className = `row-${type}`;
      let badgeClass = 'bg-warn', badgeText = 'Bƒ∞LGƒ∞';
      if (type === 'pass') { badgeClass = 'bg-pass'; badgeText = 'BA≈ûARILI'; }
      if (type === 'fail') { badgeClass = 'bg-fail'; badgeText = 'HATALI'; }

      tr.innerHTML = `
        <td><span class="status-badge ${badgeClass}">${badgeText}</span></td>
        <td>${cat}</td>
        <td>${msg.split(' - ')[0]}</td>
        <td style="font-family:monospace; font-size:0.9em; color:#aaa;">${msg}</td>
      `;
      tbody.appendChild(tr);
    }

    function updateStats() {
      document.getElementById('totalCount').textContent = results.length;
      document.getElementById('passCount').textContent = results.filter(r => r.type === 'pass').length;
      document.getElementById('failCount').textContent = results.filter(r => r.type === 'fail').length;
    }

    function filter(type) {
      document.querySelectorAll('tbody tr').forEach(row => {
        if (type === 'all') row.style.display = '';
        else row.style.display = row.classList.contains(`row-${type}`) ? '' : 'none';
      });
      document.querySelectorAll('.filter-bar button').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.filter === type);
      });
    }

    function renderEmptyFailState() {
      const tbody = document.getElementById('tableBody');
      if (!tbody) return;
      const markerId = 'emptyFailState';
      const markerRow = document.getElementById(markerId);
      const hasFail = results.some(r => r.type === 'fail');
      if (hasFail) {
        if (markerRow) markerRow.remove();
        return;
      }
      if (markerRow) return;
      const emptyRow = document.createElement('tr');
      emptyRow.id = markerId;
      emptyRow.innerHTML = `
        <td colspan="4" style="text-align:center; color:#aaa; padding:30px 10px;">
          Hata yok; sistem kontrolleri temiz.
        </td>
      `;
      tbody.appendChild(emptyRow);
    }
  </script>
</body>
</html>
